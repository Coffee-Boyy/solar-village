version: "3.9"
services:
  ushahidi:
    image: {{ ushahidi_image }}
    container_name: ushahidi
    restart: always
    environment:
      # Database through local MySQL Router RW port
      DB_HOST: 127.0.0.1
      DB_PORT: 6446
      DB_NAME: "{{ mysql_db }}"
      DB_USER: "{{ mysql_app_user }}"
      DB_PASS: "{{ mysql_app_password }}"
      BASE_URL: "{{ ushahidi_site_url }}"
      # S3 storage to MinIO
      S3_BUCKET: "ushahidi-uploads"
      S3_ENDPOINT: "http://127.0.0.1:9000"
      S3_ACCESS_KEY: "{{ minio_access_key }}"
      S3_SECRET_KEY: "{{ minio_secret_key }}"
      S3_USE_PATH_STYLE_ENDPOINT: "true"
    ports:
      - "8080:8080"
